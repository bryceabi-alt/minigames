<section class="quiz-box" id="quizBox">
  <div class="counter" id="counter"></div>

  <div class="flip-card">
    <div class="flip-card-inner" id="flipCardInner">
      <!-- Question side -->
      <div class="flip-card-front">
        <div class="question" id="question"></div>
        <div class="options" id="options"></div>
      </div>
      <!-- Feedback side -->
      <div class="flip-card-back">
        <div id="feedback" style="font-size:1.2rem; margin-bottom:20px;"></div>
        <button id="nextBtn">Next</button>
      </div>
    </div>
  </div>

  <div id="timer" style="margin-top:10px; font-weight:600; color:#ef4444;"></div>

  <div class="controls">
    <button id="backBtn">Back to Difficulty</button>
    <button id="restartBtn">Restart</button>
  </div>
</section>

<style>
.flip-card { perspective: 1000px; width: 100%; margin-top: 20px; }
.flip-card-inner {
  position: relative;
  width: 100%;
  transition: transform 0.6s;
  transform-style: preserve-3d;
}
.flip-card-front, .flip-card-back {
  position: absolute;
  width: 100%;
  backface-visibility: hidden;
}
.flip-card-back {
  transform: rotateY(180deg);
  background: #f0f9ff;
  padding: 20px;
  border-radius: 20px;
  text-align: center;
}
</style>

<script>
const hints = [
  "ICT is about technology for communication and data.",
  "Keyboard is for inputting data.",
  "Monitor shows output from computer.",
  "Hardware is physical parts of a computer.",
  "Software is programs that run on hardware.",
  "Printer prints documents.",
  "Browser is used to browse the web.",
  "Hard Drive stores data permanently.",
  "Windows is an operating system.",
  "Backspace deletes text.",
  "Email is for communication.",
  "Flash Drive is portable storage.",
  "Modem connects to internet.",
  "Google is a search engine.",
  "CPU processes data.",
  "E-learning is ICT in school.",
  "Monitor is output device.",
  "Laptop is portable computer.",
  "Hard Drive is permanent storage.",
  "Recycle Bin deletes files."
];

const explanations = [
  "Correct! ICT stands for Information and Communication Technology.",
  "Right! Keyboard is an input device.",
  "Correct! Monitor displays output.",
  "Yes! Hardware refers to physical components.",
  "Correct! Software is a program.",
  "Yes! Printer prints documents.",
  "Correct! Browsers are used to navigate the web.",
  "Right! Hard drives provide storage.",
  "Correct! Windows is an operating system.",
  "Yes! Backspace deletes text.",
  "Correct! Email is used for communication.",
  "Right! Flash drives are portable storage.",
  "Correct! Modems connect devices to the internet.",
  "Yes! Google is a search engine.",
  "Correct! CPU processes data.",
  "Right! E-learning is ICT in school.",
  "Correct! Monitor is an output device.",
  "Yes! Laptops are portable computers.",
  "Correct! Hard drives provide permanent storage.",
  "Right! Recycle Bin deletes files."
];

let filtered = [], index = 0, score = 0, currentLevel = "";
let timerInterval = null, timeLeft = 15;

const quizBox = document.getElementById("quizBox");
const resultBox = document.getElementById("resultBox");
const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const counterEl = document.getElementById("counter");
const scoreEl = document.getElementById("score");
const difficultyScreen = document.getElementById("difficultyScreen");

document.querySelectorAll("[data-level]").forEach(btn => {
  btn.onclick = () => {
    currentLevel = btn.dataset.level;
    filtered = questions.filter(q => q.l === currentLevel);
    index = score = 0;
    difficultyScreen.style.display = "none";
    quizBox.style.display = "block";
    loadQuestion();
    quizBox.scrollIntoView({ behavior: "smooth" });
  };
});

function loadQuestion() {
  const q = filtered[index];
  counterEl.textContent = `Question ${index + 1} of ${filtered.length}`;
  questionEl.textContent = q.q;
  optionsEl.innerHTML = "";
  document.getElementById('flipCardInner').style.transform = 'rotateY(0deg)';
  document.getElementById('feedback').textContent = '';

  // Timer
  timeLeft = 15;
  document.getElementById('timer').textContent = `Time Left: ${timeLeft}s`;
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    timeLeft--;
    document.getElementById('timer').textContent = `Time Left: ${timeLeft}s`;
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      showFeedback(false);
    }
  }, 1000);

  q.o.forEach((opt, i) => {
    const b = document.createElement("button");
    b.textContent = opt;
    b.onclick = () => {
      clearInterval(timerInterval);
      showFeedback(i === q.a);
    };
    optionsEl.appendChild(b);
  });
}

function showFeedback(correct) {
  const q = filtered[index];
  const feedbackEl = document.getElementById('feedback');
  document.getElementById('flipCardInner').style.transform = 'rotateY(180deg)';
  if (correct) {
    score++;
    feedbackEl.textContent = explanations[index] || "Correct!";
  } else {
    feedbackEl.textContent = `Wrong! Hint: ${hints[index] || "Think carefully!"}`;
  }
}

document.getElementById("nextBtn").onclick = () => {
  index++;
  if (index < filtered.length) loadQuestion();
  else showResult();
};

function showResult() {
  quizBox.style.display = "none";
  resultBox.style.display = "block";
  scoreEl.textContent = `${score} / ${filtered.length}`;
}

// Controls
document.getElementById("backBtn").onclick = () => {
  quizBox.style.display = "none";
  difficultyScreen.style.display = "flex";
};

document.getElementById("restartBtn").onclick = () => {
  index = score = 0;
  loadQuestion();
};

document.getElementById("restartAllBtn").onclick = () => {
  resultBox.style.display = "none";
  difficultyScreen.style.display = "flex";
};
</script>
